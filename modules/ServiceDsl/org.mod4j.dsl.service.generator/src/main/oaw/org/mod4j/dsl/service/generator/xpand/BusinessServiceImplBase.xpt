«IMPORT ServiceDsl»
«IMPORT crossx»
«IMPORT org::mod4j::dslcommon::xpand::java»

«EXTENSION org::mod4j::dsl::service::mm::xtend::ServiceMethod»
«EXTENSION org::mod4j::dslcommon::xtend::generatorutil»
«EXTENSION org::mod4j::dslcommon::xtend::ProjectProperties»
«EXTENSION org::mod4j::common::xtend::NameMapper»
«EXTENSION org::mod4j::common::xtend::FileTracker»
«EXTENSION org::mod4j::crossx::broker::xtend::Crossx» 


«DEFINE BusinessServiceImplBase FOR ServiceModel»
	«FILE generate(getBusinessModuleName(), javaDomainServiceBaseClassPath(name).javaPathFileName())»
    /**
     * DO NOT MODIFY THIS FILE, CHANGES WILL BE AUTOMATICALLY OVERWRITTEN 
     *
     * Generated by Mod4j Service DSL: BusinessServiceImpl::BusinessServiceImplBase at: «timestamp()»
     * from model «this.name»
     */
	package «getBusinessRootPackage()»;

	import java.util.List;
«REM»Import the business class  and dao for aech base of each BusinessClassDto. 
     Ensure that doules are removed.
«ENDREM»	
	«FOREACH this.uniqueBusinessClasses() AS cls -»
	    import «javaDomainClassPath(cls)»;  
    	import «javaDomainExampleClassPath(cls )»;
		import «javaDaoInterfacePath(cls)»; 
	«ENDFOREACH»

	/**
	 * @author Generated by Mod4j
	 */
	public class «javaDomainServiceBaseClass(name)» implements «javaDomainServiceBaseInterface(name)» {

	«FOREACH this.uniqueBusinessClasses() AS cls -»
		«EXPAND FieldGetterSetter::field(javaDaoInterface(cls)) FOR "the" + javaDaoInterface(cls)»    
	«ENDFOREACH»


	«EXPAND  CreateMethod  FOREACH this.uniqueMethods(MethodType::CREATE) »
	«EXPAND  ReadMethod    FOREACH this.uniqueMethods(MethodType::READ) »
	«EXPAND  UpdateMethod  FOREACH this.uniqueMethods(MethodType::UPDATE) »
	«EXPAND  DeleteMethod  FOREACH this.uniqueMethods(MethodType::DELETE) »
	«EXPAND  ListallMethod FOREACH this.uniqueMethods(MethodType::LISTALL) »
	«EXPAND  FindMethod    FOREACH this.uniqueMethods(MethodType::FIND) »

    «EXPAND  Associations FOR this»
	}
    «ENDFILE»

«ENDDEFINE»

«DEFINE Parameter FOR Parameter»
«businessClass(type)»  «this.name»
«ENDDEFINE»

«DEFINE CreateMethod FOR SpecialMethod»
    /**
     * Create a new «dto.businessClass()».
     * 
     * @param object
     *            the «dto.businessClass()» to create.
     * @return the «dto.businessClass()» created, possibly modified during creation.
     */
    public «javaDomainClass(dto.businessClass())» create«this.dto.businessClass()»(«javaDomainClass(dto.businessClass())» object) {
        return the«javaDaoInterface(dto.businessClass())».add(object);
    }
«ENDDEFINE»

«DEFINE ReadMethod FOR SpecialMethod»
    /**
     * Read an existing «dto.businessClass()».
     * 
     * @param object
     *            the id of the «dto.businessClass()» to read.
     * @return 
     */
    public «javaDomainClass(dto.businessClass())»  read«this.dto.businessClass()»(Long id){
        return the«javaDaoInterface(dto.businessClass())».retrieve(id);
    }
«ENDDEFINE»

«DEFINE UpdateMethod FOR SpecialMethod»
   /**
     * Update an existing «dto.businessClass()».
     * 
     * @param object
     *            the representation of the modified «businessClass(this.dto)».
     * @return the «businessClass(this.dto)» updated, possibly modified during update.
     */
    public «javaDomainClass(dto.businessClass())»  update«this.dto.businessClass()»(«javaDomainClass(dto.businessClass())» object) {
        return the«javaDaoInterface(dto.businessClass())».update(object);
    }
«ENDDEFINE»

«DEFINE DeleteMethod FOR SpecialMethod»
    /**
     * @param id
     *            the id of the «dto.businessClass()» to delete.
     */
    public void delete«this.dto.businessClass()»(«businessClass(this.dto)» object){
        the«javaDaoInterface(dto.businessClass())
        ».delete(object);
    }
«ENDDEFINE»

«DEFINE ListallMethod FOR SpecialMethod»
    /**
     * List all «dto.businessClass()»s.
     * 
     * @return List<«dto.businessClass()»>
     */
    public List<«javaDomainClass(dto.businessClass())»>  listAll«this.dto.businessClass()»s(){
        return the«javaDaoInterface(dto.businessClass())».listAll();
    }
«ENDDEFINE»

«DEFINE FindMethod FOR SpecialMethod»
    /**
     * Find all «dto.businessClass()» that look like the «dto.name».
     * 
     * @return List<«javaDomainClass(dto.businessClass())»>
     */
    public List<«javaDomainClass(dto.businessClass())»> findByExample(«javaDomainExampleClass(dto.businessClass())» example) {
        return this.the«javaDaoInterface(dto.businessClass())».findByExample(example);
    }
«ENDDEFINE»


«DEFINE Associations FOR ServiceModel»
	«FOREACH this.methods.typeSelect(AssociationMethod) AS method»
	«LET getAssociation(method) AS assoc» 
	«LET getPropertyValue(assoc, "Multiplicity") AS mult»
    «LET ((mult == "ONE") ? "set" : "addTo") + method.rolename.toFirstUpper() AS genName»
		«REM»The addTo method«ENDREM»	
		«IF method.type == MethodType::ADDTO»
		public void «genName»(«method.part.businessClass()» part, «method.main.businessClass()» whole) {
			whole.«genName»(part);
		}
		«ENDIF»
	
		«REM»The removefrom method«ENDREM»	
		«IF (method.type == MethodType::REMOVEFROM) && (mult == "MANY") »
		public void removeFrom«method.rolename.toFirstUpper()»(«method.part.businessClass()» part, «method.main.businessClass()» whole) {
			whole.removeFrom«method.rolename.toFirstUpper()»(part);
			the«javaDaoInterface(method.main.businessClass())».update(whole);
			the«javaDaoInterface(method.part.businessClass())».update(part);
		}
		«ENDIF»
	«ENDLET»
	«ENDLET»
	«ENDLET»
	«ENDFOREACH»
«ENDDEFINE»

