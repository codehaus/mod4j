/*******************************************************************************
 * Copyright (c) 2008 Ordina and committers to Mod4j
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *     Ordina - initial implementation
 *******************************************************************************/
import PresentationDsl;
import crossx;

extension org::mod4j::crossx::broker::xtend::Crossx;
extension org::mod4j::dsl::presentation::mm::helpers::PresentationHelpers;

//context Enumeration ERROR "4 java check enumeration already exists [" + this.name + "]" :
//       lookup(this.businessDomainModel.name, this.name, "BusinessClass") != null;
/*
context BusinessClass ERROR "Businessclass [" + this.name + "] already defined in [" + definedInResource(this.name) + "]" :
       ! classExists(this.name);
*/

context ExternalReference ERROR "there is no model " + this.modelName  + " that contains " + this.name :
       ( !findAllFromModel(this.modelName, this.name, { "Dto", "Dialogue", "Process", "Link" } ).isEmpty )
       ||
       ( !findAllFromModel(this.modelName, this.name, { "Service" } ).isEmpty )
       ;

/*
context AutomatedProcess ERROR "A save action or process must have a create and an update service method" :
    (this.type == ProcessType::SAVE) implies (
    this.services.exists(e|e.name == "create") &&
    this.services.exists(e|e.name == "update") 
    );

context AutomatedProcess ERROR "A delete action or process must have a delete service method" :
    (this.type == ProcessType::REMOVE) implies (
    this.services.exists(e|e.name == "delete") 
    );
    
context SimpleProcess ERROR "A save action or process must have a create and an update service method" :
    (this.type == ProcessType::SAVE) implies (
    this.process.services.exists(e|e.name == "create") &&
    this.process.services.exists(e|e.name == "update") 
    );

context SimpleProcess ERROR "A delete action or process must have a delete service method" :
    (this.type == ProcessType::REMOVE) implies (
    this.process.services.exists(e|e.name == "delete") 
    );
*/    
/*
context Dialogue ERROR "01 Context reference [" + this.contextRef.name + "] not defined in model " + this.contextRef.modelName :
       lookupSymbol(this.contextRef.modelName, this.contextRef.name, "Dto") != null;

context FormElement ERROR "02 Referred element [" + this.references.name + "] not defined in Dto " + this.form.contextRef.name :
	let prop = lookupSymbol(this.form.contextRef.modelName, this.references.name, "Property") :
	prop != null && getPropertyValue(prop, "owner") == this.form.contextRef.name;
*/	
	        

