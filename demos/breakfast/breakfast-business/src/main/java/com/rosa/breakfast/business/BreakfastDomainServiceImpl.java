/**
 * Generated by Mod4j Service DSL: BusinessServiceImpl::BusinessServiceImpl at: Wed Apr 01 21:03:33 CEST 2009
 * from model breakfast
 */
package com.rosa.breakfast.business;

import org.mod4j.runtime.exception.BusinessRuleException;
import org.springframework.validation.BindException;

import com.rosa.breakfast.domain.Comestible;

/**
 * @author Generated by Mod4j, use as extension point to implement custom business services
 */
public class BreakfastDomainServiceImpl extends BreakfastDomainServiceImplBase implements BreakfastDomainService {

    public boolean isComestibleUsed(Long comestibleId) {
        if (comestibleId != null) {
            return comestibleDao.isComestibleUsed(comestibleId);
        }
        return false;
    }

    @Override
    public void deleteComestible(Comestible comestible) throws BusinessRuleException {
        if (isComestibleUsed(comestible.getId())) {
            BindException errors = new BindException(comestible, "com.rosa.breakfast.domain.comestible");
            errors.rejectValue("", "comestible.br.cannotdelete", new Object[] { comestible.getName() },
                    "The comestible is linked to a standard breakfast, so it can not be deleted.");
            throw new BusinessRuleException(errors);
        }
        super.deleteComestible(comestible);
    }

}
